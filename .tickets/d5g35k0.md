---
schema_version: 1
id: d5g35k0
status: closed
closed: 2026-01-09T02:32:53Z
blocked-by: [d5g3538]
created: 2026-01-08T22:42:20Z
type: task
priority: 1
---
# Presets: Implement Lint Presets (@lint/ts, @lint/go, @lint/python, @lint/all)

## Background & Context

Lint presets protect linting/formatting configuration files from modification. Per SPEC.md:

| Preset | Description |
|--------|-------------|
| @lint/ts | TypeScript/JavaScript lint configs protected (biome, eslint, prettier, tsconfig) |
| @lint/go | Go lint configs protected (golangci) |
| @lint/python | Python lint configs protected (ruff, flake8, mypy, pylint, pyproject.toml) |
| @lint/all | All lint presets combined |

## Rationale

Linting rules are security-relevant because:
- They define code quality standards
- Disabling rules could hide security issues
- Changing formatter configs could obscure malicious changes in diffs

By protecting these files as read-only, agents can run linters but not weaken rules.

## Implementation Details

Each lint preset returns ro paths for its config files:

**@lint/ts (TypeScript/JavaScript):**
- biome.json, biome.jsonc
- .eslintrc, .eslintrc.js, .eslintrc.json, .eslintrc.yml, .eslintrc.yaml
- eslint.config.js, eslint.config.mjs, eslint.config.cjs
- .prettierrc, .prettierrc.js, .prettierrc.json, .prettierrc.yml, prettier.config.js
- tsconfig.json, tsconfig.*.json (use glob)
- .editorconfig

**@lint/go:**
- .golangci.yml, .golangci.yaml, .golangci.toml, .golangci.json
- .editorconfig

**@lint/python:**
- pyproject.toml (contains ruff, black, mypy, etc. config)
- setup.cfg (legacy config)
- .flake8
- mypy.ini, .mypy.ini
- .pylintrc, pylintrc
- ruff.toml, .ruff.toml
- .editorconfig

**@lint/all (composite preset):**
```go
func resolveLintAll(ctx PresetContext, disabled map[string]bool) PresetPaths {
    var result PresetPaths
    for _, name := range []string{"@lint/ts", "@lint/go", "@lint/python"} {
        if disabled[name] {
            continue  // Skip if negated via !@lint/ts etc.
        }
        paths := PresetRegistry[name].Resolve(ctx, disabled)
        result.Ro = append(result.Ro, paths.Ro...)
    }
    return result
}
```
This is a composite preset - it checks the `disabled` map to support negations like `!@lint/python`.

Note: All paths are relative to workDir.

## Files to Modify
- cmd/agent-sandbox/preset.go - implement all lint preset Resolve functions
- cmd/agent-sandbox/preset_test.go - test each lint preset

## Key Invariants
- All lint config paths are read-only (ro), never rw or exclude
- Paths are relative to workDir (will be absolutized during path resolution)
- Non-existent files are fine (filtered during path resolution)
- @lint/all must include all other lint presets

## Acceptance Criteria

1. @lint/ts.Resolve() returns all JS/TS lint config files as ro
2. @lint/go.Resolve() returns all Go lint config files as ro
3. @lint/python.Resolve() returns all Python lint config files as ro
4. @lint/all.Resolve() combines all lint presets (no duplicates)
5. @lint/all.Resolve() respects disabled map (skips disabled sub-presets)
6. All paths are correct relative to workDir
7. Includes comprehensive list of config files for each ecosystem
8. Tests verify each preset returns expected config files
9. Test: @lint/all with disabled["@lint/python"] excludes Python configs
