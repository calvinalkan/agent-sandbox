---
schema_version: 1
id: d5g38s8
status: closed
closed: 2026-01-09T06:09:07Z
blocked-by: [d5g389g]
created: 2026-01-08T22:49:09Z
type: task
priority: 2
---
# Error Handling: Comprehensive Error Messages with Hints

## Background & Context

Per TECHNICAL_STEERING.md Error Handling section:
> **Always wrap with context:**
> return fmt.Errorf("loading config from %s: %w", path, err)
>
> **Actionable hints when possible:**
> return fmt.Errorf("bwrap not found in PATH: %w (install with: apt install bubblewrap)", err)

Good error messages help users fix problems quickly.

## Rationale

Error messages are the primary way users understand what went wrong. Each
error should:
1. Say what failed
2. Say why it failed
3. Suggest how to fix it (when possible)

## Implementation Details

Review all error returns and ensure they have:
1. Context (what operation was being attempted)
2. The underlying error (wrapped with %w)
3. Hints where applicable

**Examples of good errors:**
```go
// Missing config file
fmt.Errorf("config file not found: %s (create with: agent-sandbox init)", path)

// Invalid preset
fmt.Errorf("unknown preset %q in config %s (available: @base, @caches, @git, @lint/*)", preset, configPath)

// Permission denied
fmt.Errorf("cannot read %s: %w (check file permissions)", path, err)

// PWD inside excluded path
fmt.Errorf("working directory %s is inside excluded path %s (change to a different directory)", pwd, excluded)

// bwrap failure
fmt.Errorf("bwrap failed: %w (check if kernel supports user namespaces: sysctl kernel.unprivileged_userns_clone)", err)
```

**Error categories to review:**
- Config loading errors
- Preset expansion errors
- Path resolution errors
- bwrap execution errors
- Command wrapper errors
- Platform validation errors

## Files to Modify
- All *.go files - review and improve error messages

## Key Invariants
- Every error has context
- Every error wraps underlying error with %w
- User-facing errors have actionable hints
- Internal errors still have context
- No bare error strings without context

## Acceptance Criteria

1. All config errors include config file path
2. All preset errors list available presets
3. Platform errors include fix hints (install bwrap, don't run as root)
4. Path errors include the problematic path
5. bwrap errors include troubleshooting hints
6. Error wrapping preserves original error for debugging
7. Code review confirms all error returns have context
